const request = require('request-promise');
import { XssVulnerabilityService } from "./model/XssVulnerabilityService";
import { Scanner } from "./Scanner";

const url = 'http://10.0.0.18/mutillidae/';
const loginToDvwa = async () => {
    await request.post({
      url: 'http://10.0.0.18/dvwa/login.php',
      form: { username: 'admin', password: 'admin', Login: 'Login' },
      simple: false,
      followAllRedirects: true,
      resolveWithFullResponse: true,
    });
}


const run = async()=> {
  //await loginToDvwa();
  const vulnerabilityService = new XssVulnerabilityService();
  const scanner = new Scanner(url, request, vulnerabilityService);
  scanner.scan();
}

run();