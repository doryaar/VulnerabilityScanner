import { Scraper } from "./Scraper";

export class Checker {

  scraper: Scraper;
  
  constructor(session: any) {
    this.scraper = new Scraper(session);
  }

  async checkXssInForm(form: string, url: string, xss: string): Promise<boolean> {
    const response = await this.scraper.submitForm(form, xss, url);
    return this.isXssInResponse(response, xss);
  }
  
  async checkXssInLink(url: string, xss: string): Promise<boolean> {
    const link = url.replace('=', `=${xss}`);
    const response = await this.scraper.get(link);
    return this.isXssInResponse(response, xss);
  }

  isXssInResponse(response: string, xss: string): boolean {
    if (response) {
      return response.includes(xss);
    }
    else return false;
  }
}